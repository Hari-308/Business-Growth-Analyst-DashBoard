<!DOCTYPE html>
<html lang="en">
<head>
    <!--
        INFOGRAPHIC PLAN
        Narrative Structure:
        1.  Hook (The Problem): Present the top-level funnel metrics, highlighting the SQL-to-Client conversion bottleneck as the primary issue.
        2.  Diagnosis (The Why): Use a comparative chart to show that the problem is not uniform, but varies by target persona.
        3.  Root Cause Analysis (The How): Visually link each persona's campaign failure to a specific stage in the AIDCA model (Attention, Conviction, Action).
        4.  Solution (The Fix): Present strategic levers and add interactive Gemini API buttons to generate email solutions in real-time.
        5.  Proof of Concept (The Result): Show early positive results from experimental prompts.

        Visualization Choices (NO SVG/MERMAID):
        -   Overall Funnel: Chart.js Bar Chart. Goal: Compare. Justification: Clearly compares actual vs. target numbers.
        -   Key KPI (SQL->Client %): "Single Big Number" display. Goal: Inform.
        -   Campaign Performance: Chart.js Bar Chart. Goal: Compare.
        -   Failure Analysis & AI Generation: HTML/CSS Flow Diagram with interactive buttons. Goal: Show relationships and provide tools.
        -   Recommendations: Styled HTML Cards. Goal: Organize.
        -   Experiment Results: Chart.js Bar Chart. Goal: Compare.
        
        CONFIRMATION: No SVG or Mermaid JS was used in this document. All diagrams are built with HTML/CSS and all charts are rendered on HTML Canvas elements via Chart.js.
        
        Color Palette: "Vibrant Corporate" (Custom)
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Growth Engine Diagnostic | DT Fellowship Submission</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .main-title {
            color: #0d1f33;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid #e5e7eb;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .kpi-value {
            color: #d62728;
            text-shadow: 1px 1px 3px rgba(214, 39, 40, 0.2);
        }
        .flow-arrow {
            font-size: 2rem;
            color: #6b4c9a;
            line-height: 1;
        }
        .palette-1 { color: #1f77b4; }
        .palette-2 { color: #ff7f0e; }
        .palette-3 { color: #2ca02c; }
        .palette-4 { color: #d62728; }
        .palette-5 { color: #9467bd; }
        .ai-button {
            background: linear-gradient(45deg, #6b4c9a, #9467bd);
            transition: all 0.3s ease;
        }
        .ai-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(148, 103, 189, 0.5);
        }
    </style>
</head>
<body class="antialiased text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-16">
            <h1 class="main-title text-4xl md:text-5xl font-extrabold mb-2">Growth Engine Diagnostic</h1>
            <p class="text-lg text-gray-600">A Strategic Deep Dive into the SQL-to-Client Conversion Funnel</p>
        </header>

        <main>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-12 text-center">
              <div class="card p-4"><p class="text-2xl font-bold main-title">3,500</p><p class="text-gray-500 text-sm">Leads</p></div>
              <div class="card p-4"><p class="text-2xl font-bold main-title">788</p><p class="text-gray-500 text-sm">SQLs</p></div>
              <div class="card p-4"><p class="text-2xl font-bold text-red-600">47</p><p class="text-gray-500 text-sm">Clients (FAIL POINT)</p></div>
              <div class="card p-4"><p class="text-2xl font-bold text-green-600">+108%</p><p class="text-gray-500 text-sm">CTR Lift (D2C Test)</p></div>
            </div>

            <section id="funnel-overview" class="mb-20">
                <h2 class="text-3xl font-bold main-title mb-4 text-center">The Primary Bottleneck</h2>
                <p class="text-gray-600 mb-10 text-center max-w-3xl mx-auto">While top-of-funnel metrics appear healthy, our growth is stalled by a critical failure late in the buyer's journey. The conversion from Sales Qualified Lead (SQL) to Client is significantly below target, representing the single largest point of leverage for growth.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
                     <div class="md:col-span-2 card p-6">
                        <h3 class="font-bold text-xl mb-6 text-gray-700">Funnel Performance vs. Targets</h3>
                        <div class="overflow-x-auto">
                            <div class="min-w-[400px] chart-container h-80 md:h-[400px]">
                                <canvas id="funnelMetricsChart"></canvas>
                            </div>
                        </div>
                     </div>
                     <div class="card p-8 text-center flex flex-col justify-center h-full">
                            <h3 class="font-bold text-lg text-gray-700 mb-2">SQL-to-Client Conversion Rate</h3>
                            <p class="kpi-value text-7xl font-extrabold my-2">6%</p>
                            <p class="text-gray-500 font-semibold text-lg">Target: 10%</p>
                            <div class="mt-4 text-sm font-bold bg-red-100 text-red-700 rounded-full px-4 py-1 inline-block">CRITICAL FAILURE POINT</div>
                     </div>
                </div>
            </section>

            <section id="campaign-diagnosis" class="mb-20">
                <h2 class="text-3xl font-bold main-title mb-4 text-center">Diagnosis: Persona Performance Breakdown</h2>
                <p class="text-gray-600 mb-10 text-center max-w-3xl mx-auto">The conversion problem isn't uniform; it's specific to how we communicate with each persona. This chart compares the conversion rate at each major stage of the funnel, revealing vastly different journey outcomes and failure points.</p>
                <div class="card p-6">
                    <h3 class="font-bold text-xl mb-6 text-gray-700">Funnel Drop-Off Rate by Persona</h3>
                    <div class="overflow-x-auto">
                        <div class="min-w-[400px] chart-container">
                            <canvas id="personaComparisonChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section id="failure-analysis" class="mb-20">
                 <h2 class="text-3xl font-bold main-title mb-4 text-center">Root Cause Analysis & AI-Powered Solutions</h2>
                 <p class="text-gray-600 mb-10 text-center max-w-3xl mx-auto">By mapping data to strategy, we can decode *why* each funnel is breaking. For each diagnosed failure, use the Gemini API to generate a targeted email fix on the spot.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="card p-6 flex flex-col items-center text-center">
                        <div class="flex-grow">
                            <p class="font-bold text-lg palette-1">CFO - Construction</p>
                            <p class="text-sm font-medium text-gray-500 mb-2">Problem: Message Misfit</p>
                            <p class="font-semibold text-red-600 mb-2">Generic Content</p>
                            <p class="font-bold text-xl palette-5">ATTENTION STAGE FAILURE</p>
                        </div>
                        <button onclick="generateEmail('cfo')" class="ai-button mt-6 text-white font-bold py-2 px-4 rounded-lg">✨ Generate Email Fix</button>
                    </div>

                    <div class="card p-6 flex flex-col items-center text-center">
                        <div class="flex-grow">
                            <p class="font-bold text-lg palette-2">CTO - D2C</p>
                            <p class="text-sm font-medium text-gray-500 mb-2">Problem: Trust Gap</p>
                            <p class="font-semibold text-red-600 mb-2">Lack of Proof</p>
                            <p class="font-bold text-xl palette-5">CONVICTION STAGE FAILURE</p>
                        </div>
                        <button onclick="generateEmail('cto')" class="ai-button mt-6 text-white font-bold py-2 px-4 rounded-lg">✨ Generate Email Fix</button>
                    </div>

                    <div class="card p-6 flex flex-col items-center text-center">
                        <div class="flex-grow">
                            <p class="font-bold text-lg palette-3">COO - Pharma</p>
                            <p class="text-sm font-medium text-gray-500 mb-2">Problem: CTA Misalignment</p>
                            <p class="font-semibold text-red-600 mb-2">No Urgency</p>
                            <p class="font-bold text-xl palette-5">ACTION STAGE FAILURE</p>
                        </div>
                        <button onclick="generateEmail('coo')" class="ai-button mt-6 text-white font-bold py-2 px-4 rounded-lg">✨ Generate Email Fix</button>
                    </div>
                </div>
                 <div id="ai-output-container" class="mt-12" style="display: none;">
                    <div class="card p-6">
                        <div class="flex justify-between items-center mb-4">
                             <h3 id="ai-output-title" class="text-xl font-bold text-gray-800"></h3>
                             <button onclick="copyToClipboard()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-1 px-3 rounded-lg text-sm">Copy</button>
                        </div>
                        <div id="ai-output-content" class="bg-gray-50 p-4 rounded-md text-sm whitespace-pre-wrap font-mono"></div>
                        <textarea id="copy-helper" style="opacity:0; position:absolute; left: -9999px;"></textarea>
                    </div>
                </div>
            </section>
            
            <section id="recommendations" class="mb-20">
                <h2 class="text-3xl font-bold main-title mb-4 text-center">The Blueprint for Growth</h2>
                <p class="text-gray-600 mb-10 text-center max-w-3xl mx-auto">The following strategic recommendations provide a clear path forward. We must shift from a uniform approach to precise interventions based on where each campaign is failing.</p>
                <div class="bg-white rounded-lg shadow-lg p-8">
                     <div class="grid grid-cols-1 md:grid-cols-5 gap-8">
                        <div class="md:col-span-2">
                             <h3 class="text-2xl font-bold text-gray-800 mb-4">Leadership Intervention Levers</h3>
                             <p class="text-gray-600">Our data points to three distinct levers. By focusing our efforts here, we can efficiently repair the funnel and accelerate client acquisition.</p>
                        </div>
                        <div class="md:col-span-3 flex flex-col gap-6">
                            <div class="flex items-start">
                                <div class="text-3xl mr-4 palette-1">🎯</div>
                                <div>
                                    <h4 class="font-bold text-lg">TARGETING</h4>
                                    <p class="text-sm text-gray-600">For the <strong class="text-gray-800">Construction CFO</strong>, halt the campaign. The messaging is fundamentally broken. We must re-evaluate the persona's core problems before relaunching.</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="text-3xl mr-4 palette-2">💬</div>
                                <div>
                                    <h4 class="font-bold text-lg">NURTURING</h4>
                                    <p class="text-sm text-gray-600">For the <strong class="text-gray-800">D2C CTO</strong> & <strong class="text-gray-800">Pharma COO</strong>, deploy revised prompts immediately. Inject 'Authority' (case studies) for D2C and 'Scarcity' (limited offers) for Pharma to fix the specific trust and urgency gaps.</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="text-3xl mr-4 palette-3">📈</div>
                                <div>
                                    <h4 class="font-bold text-lg">MEASUREMENT</h4>
                                    <p class="text-sm text-gray-600">Track the revised prompt performance via the new Experimentation Log. Specifically, monitor the 'time-to-close' for SQLs who receive scarcity-based messages to quantify the ROI of this new tactic.</p>
                                </div>
                            </div>
                        </div>
                     </div>
                </div>
            </section>
            
            <section id="proof-of-concept" class="mb-16">
                 <h2 class="text-3xl font-bold main-title mb-4 text-center">Proof of Concept: Early Results</h2>
                 <p class="text-gray-600 mb-10 text-center max-w-3xl mx-auto">Initial A/B tests of the revised prompts are already showing a significant positive impact. These early results validate our diagnostic approach and demonstrate the power of targeted, psychology-driven messaging.</p>
                <div class="card p-6">
                    <h3 class="font-bold text-xl mb-6 text-gray-700">Revised Prompt Experimentation Log</h3>
                    <div class="overflow-x-auto">
                        <div class="min-w-[400px] chart-container">
                            <canvas id="experimentResultsChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

        </main>
        
        <footer class="text-center mt-16 pt-8 border-t border-gray-300">
            <p class="text-sm text-gray-500">Project by Hari Krishna Tirukala | DT Fellowship Application</p>
            <p class="text-xs text-gray-400 mt-2">Note: Data is fictional but modeled to reflect real-world B2B campaign patterns.</p>
        </footer>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const palette = { blue: '#1f77b4', orange: '#ff7f0e', green: '#2ca02c', red: '#d62728', purple: '#9467bd', gray: '#7f7f7f' };
    const wrapLabels = (label, maxLength) => {
        if (typeof label !== 'string' || label.length <= maxLength) return label;
        const words = label.split(' ');
        const lines = [];
        let currentLine = '';
        words.forEach(word => {
            if ((currentLine + word).length > maxLength) {
                lines.push(currentLine.trim());
                currentLine = '';
            }
            currentLine += `${word} `;
        });
        lines.push(currentLine.trim());
        return lines.filter(line => line.length > 0);
    };
    const tooltipTitleCallback = (tooltipItems) => {
        const item = tooltipItems[0];
        if (!item || !item.chart.data.labels) return '';
        let label = item.chart.data.labels[item.dataIndex];
        return Array.isArray(label) ? label.join(' ') : label;
    };
    const commonChartOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
            legend: { position: 'bottom', labels: { font: { size: 12 } } },
            tooltip: {
                callbacks: { title: tooltipTitleCallback },
                backgroundColor: '#0d1f33',
                titleFont: { size: 14, weight: 'bold' },
                bodyFont: { size: 12 },
                padding: 12,
                cornerRadius: 4
            }
        },
        scales: {
            x: { grid: { display: false }, ticks: { font: { size: 12 } } },
            y: { grid: { color: '#e5e7eb' }, ticks: { font: { size: 12 } }, beginAtZero: true }
        }
    };

    new Chart(document.getElementById('funnelMetricsChart').getContext('2d'), {
        type: 'bar',
        data: {
            labels: ['Leads', 'MQLs', 'SQLs', 'Clients'],
            datasets: [
                { label: 'Actual', data: [3500, 1970, 788, 47], backgroundColor: palette.blue },
                { label: 'Target', data: [3000, 1800, 900, 90], backgroundColor: palette.gray }
            ]
        },
        options: { ...commonChartOptions, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, type: 'logarithmic' } }, plugins: { ...commonChartOptions.plugins, title: { display: true, text: 'Funnel Performance vs. Targets' } } }
    });

    new Chart(document.getElementById('personaComparisonChart').getContext('2d'), {
        type: 'bar',
        data: {
            labels: [wrapLabels('CFO - Construction', 16), wrapLabels('CTO - D2C', 16), wrapLabels('COO - Pharma', 16)],
            datasets: [
                { label: 'MQL Conversion %', data: [45, 82, 75], backgroundColor: palette.blue },
                { label: 'SQL Conversion % (from MQL)', data: [12, 30, 55], backgroundColor: palette.orange },
                { label: 'Client Conversion % (from SQL)', data: [0, 2, 6], backgroundColor: palette.red }
            ]
        },
        options: { ...commonChartOptions, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, title: { display: true, text: 'Conversion Rate (%)' } } } }
    });
    
     new Chart(document.getElementById('experimentResultsChart').getContext('2d'), {
        type: 'bar',
        data: {
            labels: ['CTR', 'Booking Rate', 'Final Conversion'],
            datasets: [{ label: 'FIX_ACTION_V1 (Pharma - Scarcity)', data: [12, 8, 1.5], backgroundColor: palette.green, }, { label: 'FIX_CONVICTION_V2 (D2C - Authority)', data: [25, 18, 4], backgroundColor: palette.purple, }]
        },
        options: { ...commonChartOptions, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, title: { display: true, text: 'Rate (%)' } } } }
    });
});

async function generateEmail(persona) {
    const outputContainer = document.getElementById('ai-output-container');
    const outputTitle = document.getElementById('ai-output-title');
    const outputContent = document.getElementById('ai-output-content');
    
    outputContainer.style.display = 'block';
    outputContent.innerHTML = '<div class="flex items-center justify-center h-full"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"></div><p class="ml-3">Generating...</p></div>';
    
    let prompt;
    let title;

    if (persona === 'cto') {
        title = "Email Fix for D2C CTO (Trust Gap)";
        prompt = "You are a world-class growth strategist. A D2C CTO has shown interest in our solution but hasn't replied to book a meeting, indicating a trust gap. Rewrite an email targeting the 'Conviction' stage of the AIDCA framework. Your primary goal is to inject the Cialdini principle of 'Authority'. Do this by including a compelling, data-rich mini-case study about a similar D2C brand directly in the email body. The case study must show a clear, quantifiable ROI. The call to action should be a low-friction invitation to discuss the findings of this case study. Avoid generic sales language.";
    } else if (persona === 'coo') {
        title = "Email Fix for Pharma COO (Weak CTA)";
        prompt = "You are a world-class growth strategist. A Pharma COO is convinced of our value but isn't taking action to sign the contract. Rewrite a final follow-up email targeting the 'Action' stage of the AIDCA framework. Inject the Cialdini principle of 'Scarcity' to create urgency. The new CTA must be tied to a credible, limited-time offer, such as a complimentary onboarding or a special benchmark report that is only available for a limited number of slots this month. The tone should be professional and firm, emphasizing the cost of inaction.";
    } else { // cfo
        title = "Email Fix for Construction CFO (Generic Message)";
        prompt = "You are a world-class growth strategist. Our current emails to Construction CFOs are being ignored due to generic messaging. Rewrite an email from scratch, focusing on the 'Attention' stage of the AIDCA framework. Use the Cialdini principle of 'Liking' by using hyper-specific industry language. The subject line and opening must reference a key financial pain point for construction firms, like 'Project Margin Erosion' or 'Capex Efficiency'. The body must speak their language, mentioning concepts like 'bid-to-win ratios' and 'improving cash flow on long-term projects.' Avoid all generic business growth buzzwords.";
    }
    
    outputTitle.textContent = title;

    try {
        let chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
        const payload = { contents: chatHistory };
        const apiKey = "";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        if (!response.ok) {
            throw new Error(`API call failed with status: ${response.status}`);
        }

        const result = await response.json();
        
        let text = 'No content generated. Please try again.';
        if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
            text = result.candidates[0].content.parts[0].text;
        }
        
        outputContent.textContent = text;
    } catch (error) {
        console.error("Gemini API call failed:", error);
        outputContent.textContent = "Failed to generate email. Please check the console for errors.";
    }
}

function copyToClipboard() {
    const content = document.getElementById('ai-output-content').textContent;
    const helper = document.getElementById('copy-helper');
    helper.value = content;
    helper.select();
    document.execCommand('copy');
    
    // Simple visual feedback
    const copyButton = document.querySelector('#ai-output-container button');
    const originalText = copyButton.textContent;
    copyButton.textContent = 'Copied!';
    setTimeout(() => {
        copyButton.textContent = originalText;
    }, 2000);
}
</script>

</body>
</html>
